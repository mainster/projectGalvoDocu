<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>XY-GalvoScanner: Analog_Macros</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xyConfCrop.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">XY-GalvoScanner
   &#160;<span id="projectnumber">1.4</span>
   </div>
   <div id="projectbrief">Galvanometer based, hybrid compensator controlled effect-laser system.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00089.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">Analog_Macros<div class="ingroups"><a class="el" href="a00084.html">MD_Application</a> &raquo; <a class="el" href="a00088.html">Analog</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Analog_Macros:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="a00089.svg" width="234" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga0a11289b824817265f02b83ec5abea78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#ga0a11289b824817265f02b83ec5abea78">ADC_RNG</a>&#160;&#160;&#160;0x0fff</td></tr>
<tr class="memdesc:ga0a11289b824817265f02b83ec5abea78"><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC code range definition. [digits].  <a href="#ga0a11289b824817265f02b83ec5abea78">More...</a><br /></td></tr>
<tr class="separator:ga0a11289b824817265f02b83ec5abea78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc312b66f7f5c01ce548561716ed2ceb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#gacc312b66f7f5c01ce548561716ed2ceb">AREF_IN_VOLT</a>&#160;&#160;&#160;(float) 2.5</td></tr>
<tr class="memdesc:gacc312b66f7f5c01ce548561716ed2ceb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analog reference input voltage definition. [V].  <a href="#gacc312b66f7f5c01ce548561716ed2ceb">More...</a><br /></td></tr>
<tr class="separator:gacc312b66f7f5c01ce548561716ed2ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa43307c49dcc90b66e0b68d7c9fdeb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#gafa43307c49dcc90b66e0b68d7c9fdeb3">VA_BIAS</a>&#160;&#160;&#160;(float) 2.5/2</td></tr>
<tr class="memdesc:gafa43307c49dcc90b66e0b68d7c9fdeb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bias level definition for the analog front-end. [V].  <a href="#gafa43307c49dcc90b66e0b68d7c9fdeb3">More...</a><br /></td></tr>
<tr class="separator:gafa43307c49dcc90b66e0b68d7c9fdeb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fe5e4a7648c5976acce2711c1630c5e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#ga7fe5e4a7648c5976acce2711c1630c5e">VLSB</a>&#160;&#160;&#160;(float) ((float) <a class="el" href="a00089.html#gacc312b66f7f5c01ce548561716ed2ceb">AREF_IN_VOLT</a> / <a class="el" href="a00089.html#ga0a11289b824817265f02b83ec5abea78">ADC_RNG</a>)</td></tr>
<tr class="memdesc:ga7fe5e4a7648c5976acce2711c1630c5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Least significant bit voltage level representation. [V].  <a href="#ga7fe5e4a7648c5976acce2711c1630c5e">More...</a><br /></td></tr>
<tr class="separator:ga7fe5e4a7648c5976acce2711c1630c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga832572d22784177b5b299eecbc9673ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#ga832572d22784177b5b299eecbc9673ae">AN_BIAS_INT</a>&#160;&#160;&#160;(uint16_t)  (0xfff+1)/2</td></tr>
<tr class="memdesc:ga832572d22784177b5b299eecbc9673ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analog offset or bias Voltage.  <a href="#ga832572d22784177b5b299eecbc9673ae">More...</a><br /></td></tr>
<tr class="separator:ga832572d22784177b5b299eecbc9673ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad36987502112cef838cb6a6c6f32595b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#gad36987502112cef838cb6a6c6f32595b">UPPER_DAC_LIMIT_SIGNED</a>&#160;&#160;&#160;(int16_t)   (0xfff-1)/2</td></tr>
<tr class="memdesc:gad36987502112cef838cb6a6c6f32595b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper DAC output limit.  <a href="#gad36987502112cef838cb6a6c6f32595b">More...</a><br /></td></tr>
<tr class="separator:gad36987502112cef838cb6a6c6f32595b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fc9d48ba45460eb9b99b364354edc75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#ga9fc9d48ba45460eb9b99b364354edc75">LOWER_DAC_LIMIT_SIGNED</a>&#160;&#160;&#160;(int16_t)  -(0xfff+1)/2</td></tr>
<tr class="memdesc:ga9fc9d48ba45460eb9b99b364354edc75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lower DAC output limit.  <a href="#ga9fc9d48ba45460eb9b99b364354edc75">More...</a><br /></td></tr>
<tr class="separator:ga9fc9d48ba45460eb9b99b364354edc75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7c68e773f4db260d02caf68c6f7020a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00089.html#gae7c68e773f4db260d02caf68c6f7020a">AMPL_FLOAT_DIVISOR</a>&#160;&#160;&#160;(int16_t)   1e3</td></tr>
<tr class="memdesc:gae7c68e773f4db260d02caf68c6f7020a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remote set-point amplitude division factor.  <a href="#gae7c68e773f4db260d02caf68c6f7020a">More...</a><br /></td></tr>
<tr class="separator:gae7c68e773f4db260d02caf68c6f7020a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section user"><dt>Pin out</dt><dd><hr/>
 <h1>20-05-2015 </h1>
</dd></dl>
<pre class="fragment">// Set-point (external)
// Auf prototyp Signal v1.3 wurde dazu einer der
// I_Sens_X/Y Kan√§le benutzt
</pre><h2>CHAN ADC1 ADC2 ADC3 </h2>
<p>0 PA0 PA0 PA0 1 PA1 PA1 PA1 2 PA2 PA2 PA2 3 PA3 PA3 PA3 4 PA4 PA4 PF6 5 PA5 PA5 PF7 6 PA6 PA6 PF8 7 PA7 PA7 PF9 8 PB0 PB0 PF10 9 PB1 PB1 PF3 10 PC0 PC0 PC0 11 PC1 PC1 PC1 12 PC2 PC2 PC2 13 PC3 PC3 PC3 14 PC4 PC4 PF4 15 PC5 PC5 PF5</p>
<h2>Signal v1.3 proto </h2>
<p>PC3 Isens_X PA3 Isens_Y PA6 pos_X -&mdash;P-A-7&mdash;p-o-s_-Y&ndash; PB0 pos_Y</p>
<p>Bei ADC dual-mode: ADC1_CH06 pos_X (PA6) ADC2_CH07 pos_Y (PB0)</p>
<p>Zum testen, triplemode (prototyp v1.3) ADC3_CH03 setpoint=Isens_X (PA3)</p>
<p>Zum testen, dualmode (prototyp v1.3) ADC2_CH03 setpoint=Isens_X (PA3) </p><dl class="section user"><dt>TODO:</dt><dd>Ob multimode fuer X und Y Position sinnvoll ist, muss getestet werden. Multimode bedeutet, dass 2 oder sogar 3 Wandlungen synchron ablaufen. Wenn ein "start Conversion" trigger an ADC1 gesendet wird, starten ADC2 und ggf ADC3 ebenfalls eine Wandlung. Der DMA controller kann so konfiguriert werden, dass bei einem DMA-request einer der 2(3) ADC-Werte ins SRAM geschrieben wird Oder dass bei einem DMA-request zwei ADC Werte (dual half-word) gleichzeitig ins SRAM uebertragen werden. =&gt; Sinnvoll zb. bei einem Zustandsregler, dort werden position und und Wicklungsstrom vom gleichen Zeitpunkt benoetigt. </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga0a11289b824817265f02b83ec5abea78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADC_RNG&#160;&#160;&#160;0x0fff</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>ADC code range definition. [digits]. </p>
<p>Since both embedded ADC hardware cells are configured to operate at full 12-Bit resolution, the ADC result register values are ranged between 0...0x0fff.</p>
<dl class="section note"><dt>Note</dt><dd>Remember to consider the analog front-end biasing behavior. The peak-voltage resolution of a full scaled sinusoidal input signal reaches only half the ADC-resolution since output values of the angular position decoder can be positive or negative. In other words: The angular displacement of the rotor can achieve in clockwise and counterclockwise direction. </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00178">178</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="gae7c68e773f4db260d02caf68c6f7020a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AMPL_FLOAT_DIVISOR&#160;&#160;&#160;(int16_t)   1e3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Remote set-point amplitude division factor. </p>
<p>To mitigate the processing load for remotely (Qt console interface) performed set-point updates, they were transferred as binary coded short integers (16-Bit). The AMPL_FLOAT_DIVISOR is used to scale the binary set-point data. In other words, this parameter determines the resolution as well as the absolute reading of the set-point amplitude values. </p>

<p>Definition at line <a class="el" href="a00018_source.html#l00261">261</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga832572d22784177b5b299eecbc9673ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AN_BIAS_INT&#160;&#160;&#160;(uint16_t)  (0xfff+1)/2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Analog offset or bias Voltage. </p>
<p>Rounded representation of the analog offset or bias voltage as integral data type.</p>
<dl class="section note"><dt>Note</dt><dd>This evaluates to \((4095+1)/2 = 2048\) which could physically be expressed as \(VLSB*AN_BIAS_INT = 1.2503V$ @a pprox VA_BIAS\) </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00227">227</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="gacc312b66f7f5c01ce548561716ed2ceb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AREF_IN_VOLT&#160;&#160;&#160;(float) 2.5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Analog reference input voltage definition. [V]. </p>
<p>Both embedded analog units of the STM32F4xx can be configured to use different reference signal sources such as an external voltage signal or the internal bandgap circuits.</p>
<dl class="section note"><dt>Note</dt><dd>If both AD- and DA- converter configured for the external reference source, they has to operate on a common analog reference signal. </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00191">191</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga9fc9d48ba45460eb9b99b364354edc75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOWER_DAC_LIMIT_SIGNED&#160;&#160;&#160;(int16_t)  -(0xfff+1)/2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Lower DAC output limit. </p>
<p>Lower limit of digital-to-analog converter output signal, represented as integral data type.</p>
<dl class="section note"><dt>Note</dt><dd>This evaluates to \((4095-1)/2 = 2046\) which could physically be expressed as \(VLSB*LOWER_DAC_LIMIT_SIGNED = 1.2503V\). </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00249">249</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad36987502112cef838cb6a6c6f32595b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPPER_DAC_LIMIT_SIGNED&#160;&#160;&#160;(int16_t)   (0xfff-1)/2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Upper DAC output limit. </p>
<p>Upper limit of digital-to-analog converter output signal, represented as integral data type.</p>
<dl class="section note"><dt>Note</dt><dd>This evaluates to \((4095-1)/2 = 2046\) which could physically be expressed as \(VLSB*UPPER_DAC_LIMIT_SIGNED = 1.24908V\). </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00238">238</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="gafa43307c49dcc90b66e0b68d7c9fdeb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VA_BIAS&#160;&#160;&#160;(float) 2.5/2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Bias level definition for the analog front-end. [V]. </p>
<dl class="section note"><dt>Note</dt><dd>See <a class="el" href="a00089.html#ga0a11289b824817265f02b83ec5abea78">ADC_RNG</a>, </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00198">198</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga7fe5e4a7648c5976acce2711c1630c5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VLSB&#160;&#160;&#160;(float) ((float) <a class="el" href="a00089.html#gacc312b66f7f5c01ce548561716ed2ceb">AREF_IN_VOLT</a> / <a class="el" href="a00089.html#ga0a11289b824817265f02b83ec5abea78">ADC_RNG</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="a00018.html">globals.h</a>&gt;</code></p>

<p>Least significant bit voltage level representation. [V]. </p>
<p>Some calculations are easier to perform using the minimum quantization level for the analog subsystems.</p>
<dl class="section note"><dt>Note</dt><dd>Differences between an ADCs resolution, the ENOB (effective number of bits), THD (total harmonic distortion), SINHD (SIgnal-to-Noise-And-Distortion), DR (Dynamic Range) and SFDR (Spurious-Free Dynamic Range) must considered carefully when designing analog and/or digital filter stages. A good summary (or point of start) to that topic can be found under <a href="http://www.analog.com/en/analog-dialogue/articles/adc-input-noise.html">http://www.analog.com/en/analog-dialogue/articles/adc-input-noise.html</a></dd>
<dd>
This evaluates to \(2.5V/(2^12-1) = 610.5uV/dig\). </dd></dl>

<p>Definition at line <a class="el" href="a00018_source.html#l00216">216</a> of file <a class="el" href="a00018_source.html">globals.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Mar 14 2017 19:31:41 for XY-GalvoScanner by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
